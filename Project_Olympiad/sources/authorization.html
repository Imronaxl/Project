<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TAJIK FIRE</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css ">
    <style>
        :root {
            --primary-color: #e67e22;
            --secondary-color: #2c3e50;
            --accent-color: #3498db;
            --success-color: #2ecc71;
            --danger-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background: linear-gradient(135deg, #1c1f1c, #2c3e50);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--light-color);
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }
        .container {
            width: 100%;
            max-width: 1200px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .language-switcher {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
            background: rgba(44, 62, 80, 0.7);
            border-radius: 5px;
            backdrop-filter: blur(5px);
            border: 1px solid var(--primary-color);
            overflow: hidden;
        }
        .language-switcher select {
            background: transparent;
            color: var(--light-color);
            border: none;
            padding: 10px 35px 10px 15px;
            font-size: 1rem;
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23ecf0f1'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 15px;
            width: 150px;
        }
        .language-switcher select:focus {
            outline: none;
            box-shadow: 0 0 0 2px rgba(230, 126, 34, 0.5);
        }
        .language-switcher select option {
            background: #2c3e50;
            color: white;
            padding: 10px;
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
            width: 100%;
        }
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        .logo-icon {
            font-size: 3rem;
            color: var(--primary-color);
            animation: pulse 2s infinite;
        }
        h1 {
            font-size: 3rem;
            background: linear-gradient(to right, var(--primary-color), #f1c40f);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            margin-bottom: 10px;
        }
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.8;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }
        .auth-container {
            width: 100%;
            max-width: 500px;
            background: rgba(44, 62, 80, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .auth-header {
            text-align: center;
            margin-bottom: 30px;
        }
        .auth-title {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--light-color);
        }
        .auth-subtitle {
            font-size: 1rem;
            opacity: 0.8;
        }
        .tabs {
            display: flex;
            margin-bottom: 30px;
            background: rgba(52, 73, 94, 0.5);
            border-radius: 50px;
            padding: 5px;
        }
        .tab {
            flex: 1;
            text-align: center;
            padding: 12px;
            cursor: pointer;
            border-radius: 50px;
            transition: var(--transition);
            font-weight: 600;
        }
        .tab.active {
            background: var(--primary-color);
            color: white;
        }
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .form-input {
            width: 100%;
            padding: 14px;
            border-radius: 10px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background: rgba(52, 73, 94, 0.5);
            color: var(--light-color);
            font-size: 1rem;
            transition: var(--transition);
        }
        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(230, 126, 34, 0.3);
        }
        .password-container {
            position: relative;
        }
        .toggle-password {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: rgba(255, 255, 255, 0.5);
            transition: var(--transition);
        }
        .toggle-password:hover {
            color: var(--light-color);
        }
        .btn {
            width: 100%;
            padding: 14px;
            border-radius: 10px;
            border: none;
            background: var(--primary-color);
            color: white;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            box-shadow: var(--shadow);
        }
        .btn:hover {
            background: #d35400;
            transform: translateY(-3px);
            box-shadow: 0 7px 14px rgba(0, 0, 0, 0.2);
        }
        .btn:active {
            transform: translateY(0);
        }
        .btn:disabled {
            background: #7f8c8d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .divider {
            display: flex;
            align-items: center;
            margin: 25px 0;
        }
        .divider::before,
        .divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: rgba(255, 255, 255, 0.1);
        }
        .divider-text {
            padding: 0 15px;
            opacity: 0.7;
        }
        .social-login {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }
        .social-btn {
            flex: 1;
            padding: 12px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(52, 73, 94, 0.5);
            color: var(--light-color);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
        }
        .social-btn:hover {
            background: rgba(52, 73, 94, 0.8);
            transform: translateY(-2px);
        }
        .footer {
            text-align: center;
            margin-top: 20px;
            font-size: 0.9rem;
            opacity: 0.7;
        }
        .footer a {
            color: var(--primary-color);
            text-decoration: none;
            transition: var(--transition);
        }
        .footer a:hover {
            text-decoration: underline;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .modal.active {
            display: flex;
            opacity: 1;
        }
        .modal-content {
            background: rgba(44, 62, 80, 0.95);
            border-radius: 15px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            transform: scale(0.9);
            border: 1px solid rgba(230, 126, 34, 0.3);
        }
        .modal-header {
            padding: 20px;
            background: rgba(230, 126, 34, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .modal-title {
            font-size: 1.5rem;
            color: var(--light-color);
        }
        .modal-close {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.5);
            font-size: 1.5rem;
            cursor: pointer;
            transition: var(--transition);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .modal-close:hover {
            background: rgba(231, 76, 60, 0.2);
            color: var(--danger-color);
        }
        .modal-body {
            padding: 25px;
        }
        .security-indicator {
            height: 5px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            margin-bottom: 25px;
            overflow: hidden;
        }
        .security-bar {
            height: 100%;
            width: 0%;
            background: var(--danger-color);
            transition: width 0.5s ease;
        }
        .security-rules {
            margin-bottom: 20px;
        }
        .rule {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            font-size: 0.9rem;
        }
        .rule i {
            color: var(--danger-color);
        }
        .rule.valid i {
            color: var(--success-color);
        }
        .countdown {
            text-align: center;
            font-size: 1.2rem;
            margin: 20px 0;
            color: var(--primary-color);
            font-weight: 600;
        }
        .resend-link {
            text-align: center;
            margin-top: 20px;
        }
        .resend-link a {
            color: var(--accent-color);
            cursor: pointer;
            text-decoration: none;
        }
        .resend-link a:hover {
            text-decoration: underline;
        }
        .success-message {
            background: rgba(46, 204, 113, 0.1);
            border: 1px solid rgba(46, 204, 113, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            display: none;
        }
        .success-message i {
            color: var(--success-color);
            font-size: 2rem;
            margin-bottom: 10px;
        }
        .error-message {
            background: rgba(231, 76, 60, 0.1);
            border: 1px solid rgba(231, 76, 60, 0.3);
            border-radius: 10px;
            padding: 10px;
            margin: 10px 0;
            color: var(--danger-color);
            font-size: 0.9rem;
            display: none;
        }
        .loader {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes scaleIn {
            from { transform: scale(0.9); }
            to { transform: scale(1); }
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="language-switcher">
            <select id="language-select">
                <option value="russian">🇷🇺 Русский</option>
                <option value="english">🇺🇸 English</option>
                <option value="tajik">🇹🇯 Тоҷикӣ</option>
            </select>
        </div>
        <div class="header">
            <div class="logo">
                <i class="fas fa-fire logo-icon"></i>
                <h1>TAJIK FIRE</h1>
            </div>
            <p class="subtitle">Платформа для олимпиадного программирования</p>
        </div>
        <div class="auth-container">
            <div class="auth-header">
                <h2 class="auth-title">Вход и Регистрация</h2>
                <p class="auth-subtitle">Используйте безопасный вход с подтверждением личности</p>
            </div>
            <div class="tabs">
                <div class="tab active" id="login-tab">Войти</div>
                <div class="tab" id="register-tab">Регистрация</div>
            </div>
            <form id="login-form">
                <div class="form-group">
                    <label for="login-email" class="form-label">
                        <i class="fas fa-envelope"></i>Email
                    </label>
                    <input type="email" id="login-email" class="form-input" placeholder="your@email.com" required>
                </div>
                <div class="form-group">
                    <label for="login-password" class="form-label">
                        <i class="fas fa-lock"></i>Пароль
                    </label>
                    <div class="password-container">
                        <input type="password" id="login-password" class="form-input" placeholder="Ваш пароль" required>
                        <i class="fas fa-eye toggle-password" id="toggle-login-password"></i>
                    </div>
                </div>
                <div class="form-group">
                    <div class="error-message" id="login-error"></div>
                    <button type="submit" class="btn" id="login-btn">
                        <span id="login-loader" class="loader" style="display:none"></span>
                        <i class="fas fa-sign-in-alt"></i> <span id="login-text">Войти</span>
                    </button>
                </div>
            </form>
            <form id="register-form" style="display: none;">
                <div class="form-group">
                    <label for="register-username" class="form-label">
                        <i class="fas fa-user"></i>Имя пользователя
                    </label>
                    <input type="text" id="register-username" class="form-input" placeholder="Придумайте имя" required>
                </div>
                <div class="form-group">
                    <label for="register-login" class="form-label">
                        <i class="fas fa-at"></i>Логин
                    </label>
                    <input type="text" id="register-login" class="form-input" placeholder="Ваш логин" required>
                </div>
                <div class="form-group">
                    <label for="register-email" class="form-label">
                        <i class="fas fa-envelope"></i>Email
                    </label>
                    <input type="email" id="register-email" class="form-input" placeholder="your@email.com" required>
                </div>
                <div class="form-group">
                    <label for="register-password" class="form-label">
                        <i class="fas fa-lock"></i>Пароль
                    </label>
                    <div class="password-container">
                        <input type="password" id="register-password" class="form-input" placeholder="Создайте пароль" required>
                        <i class="fas fa-eye toggle-password" id="toggle-register-password"></i>
                    </div>
                    <div class="security-indicator">
                        <div class="security-bar" id="security-bar"></div>
                    </div>
                    <div class="security-rules">
                        <div class="rule" id="rule-length">
                            <i class="fas fa-times"></i> Минимум 8 символов
                        </div>
                        <div class="rule" id="rule-uppercase">
                            <i class="fas fa-times"></i> Заглавная буква
                        </div>
                        <div class="rule" id="rule-number">
                            <i class="fas fa-times"></i> Хотя бы одна цифра
                        </div>
                        <div class="rule" id="rule-special">
                            <i class="fas fa-times"></i> Специальный символ
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label for="register-confirm" class="form-label">
                        <i class="fas fa-lock"></i>Подтвердите пароль
                    </label>
                    <div class="password-container">
                        <input type="password" id="register-confirm" class="form-input" placeholder="Повторите пароль" required>
                        <i class="fas fa-eye toggle-password" id="toggle-register-confirm"></i>
                    </div>
                    <div class="error-message" id="register-error"></div>
                </div>
                <div class="form-group">
                    <button type="submit" class="btn" id="register-btn">
                        <span id="register-loader" class="loader" style="display:none"></span>
                        <i class="fas fa-user-plus"></i> <span id="register-text">Зарегистрироваться</span>
                    </button>
                </div>
            </form>
            <div class="divider">
                <span class="divider-text">или</span>
            </div>
            <div class="social-login">
                <button class="social-btn">
                    <i class="fab fa-google"></i> Google
                </button>
                <button class="social-btn">
                    <i class="fab fa-github"></i> GitHub
                </button>
                <button class="social-btn">
                    <i class="fab fa-microsoft"></i> Microsoft
                </button>
            </div>
            <div class="footer">
                <p>Нажимая кнопку, вы соглашаетесь с нашими <a href="#">Условиями использования</a> и <a href="#">Политикой конфиденциальности</a></p>
            </div>
        </div>
    </div>
    <div class="modal" id="confirmation-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Подтверждение Email</h3>
                <button class="modal-close" id="close-confirm-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p>Мы отправили 6-значный код подтверждения на ваш email. Пожалуйста, введите его ниже:</p>
                <div class="form-group" style="margin-top: 25px;">
                    <label for="confirmation-code" class="form-label">
                        <i class="fas fa-key"></i>Код подтверждения
                    </label>
                    <input type="text" id="confirmation-code" class="form-input" placeholder="Введите 6-значный код" maxlength="6" required>
                    <div class="error-message" id="confirm-error"></div>
                </div>
                <div class="countdown" id="countdown">03:00</div>
                <div class="form-group">
                    <button class="btn" id="confirm-btn">
                        <span id="confirm-loader" class="loader" style="display:none"></span>
                        <i class="fas fa-check-circle"></i> <span id="confirm-text">Подтвердить</span>
                    </button>
                </div>
                <div class="resend-link">
                    <a id="resend-code">Отправить код повторно</a>
                </div>
                <div class="success-message" id="success-message">
                    <i class="fas fa-check-circle"></i>
                    <h3>Успешно подтверждено!</h3>
                    <p>Ваш email успешно подтверждён. Теперь вы можете войти в систему.</p>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Объект с переводами для всех элементов
        const translations = {
            russian: {
                title: "TAJIK FIRE",
                subtitle: "Платформа для олимпиадного программирования",
                authTitle: "Вход и Регистрация",
                authSubtitle: "Используйте безопасный вход с подтверждением личности",
                loginTab: "Войти",
                registerTab: "Регистрация",
                emailLabel: "Email",
                passwordLabel: "Пароль",
                loginButton: "Войти",
                usernameLabel: "Имя пользователя",
                loginLabel: "Логин",
                confirmPassword: "Подтвердите пароль",
                registerButton: "Зарегистрироваться",
                orText: "или",
                termsText: "Нажимая кнопку, вы соглашаетесь с нашими",
                andText: "и",
                termsLink1: "Условиями использования",
                termsLink2: "Политикой конфиденциальности",
                confirmationTitle: "Подтверждение Email",
                confirmationText: "Мы отправили 6-значный код подтверждения на ваш email. Пожалуйста, введите его ниже:",
                codeLabel: "Код подтверждения",
                confirmButton: "Подтвердить",
                resendCode: "Отправить код повторно",
                successTitle: "Успешно подтверждено!",
                successText: "Ваш email успешно подтверждён. Теперь вы можете войти в систему.",
                ruleLength: "Минимум 8 символов",
                ruleUppercase: "Заглавная буква",
                ruleNumber: "Хотя бы одна цифра",
                ruleSpecial: "Специальный символ",
                emailPlaceholder: "your@email.com",
                passwordPlaceholder: "Ваш пароль",
                usernamePlaceholder: "Придумайте имя",
                loginPlaceholder: "Ваш логин",
                passwordCreatePlaceholder: "Создайте пароль",
                passwordConfirmPlaceholder: "Повторите пароль",
                codePlaceholder: "Введите 6-значный код",
                fillFields: "Заполните все поля",
                passwordMismatch: "Пароли не совпадают",
                passwordWeak: "Пароль недостаточно сложен",
                invalidEmail: "Неверный формат email",
                codeInvalid: "Пожалуйста, введите 6-значный код",
                serverError: "Ошибка соединения с сервером"
            },
            english: {
                title: "TAJIK FIRE",
                subtitle: "Platform for programming competitions",
                authTitle: "Login and Registration",
                authSubtitle: "Use secure login with identity verification",
                loginTab: "Login",
                registerTab: "Register",
                emailLabel: "Email",
                passwordLabel: "Password",
                loginButton: "Sign In",
                usernameLabel: "Username",
                loginLabel: "Login",
                confirmPassword: "Confirm Password",
                registerButton: "Register",
                orText: "or",
                termsText: "By clicking the button, you agree to our",
                andText: "and",
                termsLink1: "Terms of Use",
                termsLink2: "Privacy Policy",
                confirmationTitle: "Email Confirmation",
                confirmationText: "We've sent a 6-digit confirmation code to your email. Please enter it below:",
                codeLabel: "Confirmation Code",
                confirmButton: "Confirm",
                resendCode: "Resend Code",
                successTitle: "Successfully Confirmed!",
                successText: "Your email has been successfully confirmed. You can now log in.",
                ruleLength: "Minimum 8 characters",
                ruleUppercase: "Uppercase letter",
                ruleNumber: "At least one number",
                ruleSpecial: "Special character",
                emailPlaceholder: "your@email.com",
                passwordPlaceholder: "Your password",
                usernamePlaceholder: "Choose a username",
                loginPlaceholder: "Your login",
                passwordCreatePlaceholder: "Create password",
                passwordConfirmPlaceholder: "Confirm password",
                codePlaceholder: "Enter 6-digit code",
                fillFields: "Fill all fields",
                passwordMismatch: "Passwords do not match",
                passwordWeak: "Password is not strong enough",
                invalidEmail: "Invalid email format",
                codeInvalid: "Please enter 6-digit code",
                serverError: "Server connection error"
            },
            tajik: {
                title: "TAJIK FIRE",
                subtitle: "Платформа барои мусобиқаҳои барномасозӣ",
                authTitle: "Даромад ва Бақайдгирӣ",
                authSubtitle: "Истифодаи вуруди бехатар бо тасдиқи ҳувият",
                loginTab: "Даромадан",
                registerTab: "Бақайдгирӣ",
                emailLabel: "Почтаи электронӣ",
                passwordLabel: "Рамз",
                loginButton: "Даромадан",
                usernameLabel: "Номи корбар",
                loginLabel: "Логин",
                confirmPassword: "Тасдиқи рамз",
                registerButton: "Ба қайд гирифтан",
                orText: "ё",
                termsText: "Бо пахш кардани тугма, шумо бо қабул мекунед",
                andText: "ва",
                termsLink1: "Шартҳои истифода",
                termsLink2: "Сиёсати махфият",
                confirmationTitle: "Тасдиқи почтаи электронӣ",
                confirmationText: "Мо рамзи тасдиқи 6-рақамаро ба почтаи электронии шумо фиристодем. Лутфан онро дар зер ворид кунед:",
                codeLabel: "Рамзи тасдиқӣ",
                confirmButton: "Тасдиқ кардан",
                resendCode: "Бозфиристодани рамз",
                successTitle: "Бомуваффақият тасдиқ шуд!",
                successText: "Почтаи электронии шумо бомуваффақият тасдиқ шуд. Ҳоло шумо метавонед ворид шавед.",
                ruleLength: "Ҳадди ақал 8 аломат",
                ruleUppercase: "Ҳарфи калон",
                ruleNumber: "Ақаллан як рақам",
                ruleSpecial: "Аломати махсус",
                emailPlaceholder: "шумо@email.com",
                passwordPlaceholder: "Рамзи шумо",
                usernamePlaceholder: "Номи корбарро интихоб кунед",
                loginPlaceholder: "Логини шумо",
                passwordCreatePlaceholder: "Эҷоди рамз",
                passwordConfirmPlaceholder: "Тасдиқи рамз",
                codePlaceholder: "Рамзи 6-рақамаро ворид кунед",
                fillFields: "Ҳама майдонҳоро пур кунед",
                passwordMismatch: "Рамзҳо мувофиқат намекунанд",
                passwordWeak: "Рамз боварӣ намедорад",
                invalidEmail: "Формати нодурусти почта",
                codeInvalid: "Лутфан рамзи 6-рақамаро ворид кунед",
                serverError: "Хатогии алоқа бо сервер"
            }
        };

        // Функция для применения перевода
        function applyLanguage(lang) {
            const langData = translations[lang] || translations.ru;
            currentLang = lang;
            document.getElementById('language-select').value = lang;
            document.cookie = `language=${lang}; max-age=${365 * 24 * 60 * 60}; path=/`;
            
            // Обновляем основные заголовки
            document.querySelector('h1').textContent = langData.title;
            document.querySelector('.subtitle').textContent = langData.subtitle;
            document.querySelector('.auth-title').textContent = langData.authTitle;
            document.querySelector('.auth-subtitle').textContent = langData.authSubtitle;
            
            // Обновляем вкладки
            document.getElementById('login-tab').textContent = langData.loginTab;
            document.getElementById('register-tab').textContent = langData.registerTab;
            
            // Обновляем метки форм
            document.querySelector('label[for="login-email"]').innerHTML = `<i class="fas fa-envelope"></i>${langData.emailLabel}`;
            document.querySelector('label[for="login-password"]').innerHTML = `<i class="fas fa-lock"></i>${langData.passwordLabel}`;
            document.querySelector('label[for="register-username"]').innerHTML = `<i class="fas fa-user"></i>${langData.usernameLabel}`;
            document.querySelector('label[for="register-login"]').innerHTML = `<i class="fas fa-at"></i>${langData.loginLabel}`;
            document.querySelector('label[for="register-email"]').innerHTML = `<i class="fas fa-envelope"></i>${langData.emailLabel}`;
            document.querySelector('label[for="register-password"]').innerHTML = `<i class="fas fa-lock"></i>${langData.passwordLabel}`;
            document.querySelector('label[for="register-confirm"]').innerHTML = `<i class="fas fa-lock"></i>${langData.confirmPassword}`;
            document.querySelector('label[for="confirmation-code"]').innerHTML = `<i class="fas fa-key"></i>${langData.codeLabel}`;
            
            // Обновляем правила пароля
            document.getElementById('rule-length').innerHTML = `<i class="fas fa-times"></i> ${langData.ruleLength}`;
            document.getElementById('rule-uppercase').innerHTML = `<i class="fas fa-times"></i> ${langData.ruleUppercase}`;
            document.getElementById('rule-number').innerHTML = `<i class="fas fa-times"></i> ${langData.ruleNumber}`;
            document.getElementById('rule-special').innerHTML = `<i class="fas fa-times"></i> ${langData.ruleSpecial}`;
            
            // Обновляем разделитель
            document.querySelector('.divider-text').textContent = langData.orText;
            
            // Обновляем модальное окно
            document.querySelector('.modal-title').textContent = langData.confirmationTitle;
            document.querySelector('.modal-body p').textContent = langData.confirmationText;
            document.getElementById('resend-code').textContent = langData.resendCode;
            
            // Обновляем сообщение об успехе
            const successMessage = document.getElementById('success-message');
            successMessage.querySelector('h3').textContent = langData.successTitle;
            successMessage.querySelector('p').textContent = langData.successText;
            
            // Обновляем футер
            const footer = document.querySelector('.footer p');
            footer.innerHTML = `
                ${langData.termsText} 
                <a href="#">${langData.termsLink1}</a> 
                ${langData.andText} 
                <a href="#">${langData.termsLink2}</a>
            `;
            
            // Обновляем плейсхолдеры
            document.getElementById('login-email').placeholder = langData.emailPlaceholder;
            document.getElementById('login-password').placeholder = langData.passwordPlaceholder;
            document.getElementById('register-username').placeholder = langData.usernamePlaceholder;
            document.getElementById('register-login').placeholder = langData.loginPlaceholder;
            document.getElementById('register-email').placeholder = langData.emailPlaceholder;
            document.getElementById('register-password').placeholder = langData.passwordCreatePlaceholder;
            document.getElementById('register-confirm').placeholder = langData.passwordConfirmPlaceholder;
            document.getElementById('confirmation-code').placeholder = langData.codePlaceholder;
            
            // Обновляем кнопки
            document.getElementById('login-text').textContent = langData.loginButton;
            document.getElementById('register-text').textContent = langData.registerButton;
            document.getElementById('confirm-text').textContent = langData.confirmButton;
        }

        // Получение языка из cookie
        function getLangFromCookie() {
            const match = document.cookie
                .split('; ')
                .find(row => row.startsWith('language='));
            return match ? match.split('=')[1] : 'ru';
        }

        // Установка кастомных сообщений валидации
        function setValidationMessages() {
            document.querySelectorAll('input[required]').forEach(input => {
                input.addEventListener('invalid', e => {
                    e.preventDefault();
                    input.setCustomValidity(translations[currentLang].fillFields);
                }, { once: true });
                
                input.addEventListener('input', () => {
                    input.setCustomValidity('');
                });
            });
        }

        // Инициализация
        document.addEventListener('DOMContentLoaded', () => {
            currentLang = getLangFromCookie();
            applyLanguage(currentLang);
            setValidationMessages();
        });

        // Переключение между вкладками
        const loginTab = document.getElementById('login-tab');
        const registerTab = document.getElementById('register-tab');
        const loginForm = document.getElementById('login-form');
        const registerForm = document.getElementById('register-form');
        const loginError = document.getElementById('login-error');
        const registerError = document.getElementById('register-error');

        loginTab.addEventListener('click', () => {
            loginTab.classList.add('active');
            registerTab.classList.remove('active');
            loginForm.style.display = 'block';
            registerForm.style.display = 'none';
            loginError.style.display = 'none';
        });

        registerTab.addEventListener('click', () => {
            registerTab.classList.add('active');
            loginTab.classList.remove('active');
            registerForm.style.display = 'block';
            loginForm.style.display = 'none';
            registerError.style.display = 'none';
        });

        // Показать/скрыть пароль
        document.querySelectorAll('.toggle-password').forEach(toggle => {
            toggle.addEventListener('click', function() {
                const input = this.previousElementSibling;
                const type = input.type === 'password' ? 'text' : 'password';
                input.type = type;
                this.classList.toggle('fa-eye');
                this.classList.toggle('fa-eye-slash');
            });
        });

        // Валидация пароля
        const passwordInput = document.getElementById('register-password');
        const securityBar = document.getElementById('security-bar');
        const rules = {
            length: document.getElementById('rule-length'),
            uppercase: document.getElementById('rule-uppercase'),
            number: document.getElementById('rule-number'),
            special: document.getElementById('rule-special')
        };

        passwordInput.addEventListener('input', function() {
            const password = this.value;
            let strength = 0;
            
            // Проверка длины
            if (password.length >= 8) {
                strength += 25;
                rules.length.classList.add('valid');
            } else {
                rules.length.classList.remove('valid');
            }
            
            // Проверка на заглавные буквы
            if (/[A-Z]/.test(password)) {
                strength += 25;
                rules.uppercase.classList.add('valid');
            } else {
                rules.uppercase.classList.remove('valid');
            }
            
            // Проверка на цифры
            if (/\d/.test(password)) {
                strength += 25;
                rules.number.classList.add('valid');
            } else {
                rules.number.classList.remove('valid');
            }
            
            // Проверка на специальные символы
            if (/[!@#$%^&*(),.?":{}|<>]/.test(password)) {
                strength += 25;
                rules.special.classList.add('valid');
            } else {
                rules.special.classList.remove('valid');
            }
            
            // Обновление индикатора
            securityBar.style.width = strength + '%';
            
            // Цвет индикатора
            if (strength < 50) {
                securityBar.style.backgroundColor = 'var(--danger-color)';
            } else if (strength < 75) {
                securityBar.style.backgroundColor = '#f39c12';
            } else {
                securityBar.style.backgroundColor = 'var(--success-color)';
            }
        });

        // Модальное окно
        let confirmationEmail = '';
        function showConfirmationModal() {
            document.getElementById('confirmation-modal').classList.add('active');
            startCountdown(180);
        }

        let countdownInterval;
        function startCountdown(seconds) {
            clearInterval(countdownInterval);
            let remaining = seconds;
            countdownInterval = setInterval(() => {
                const minutes = Math.floor(remaining / 60);
                const secs = remaining % 60;
                document.getElementById('countdown').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
                if (remaining <= 0) {
                    clearInterval(countdownInterval);
                    document.getElementById('countdown').textContent = 'Время истекло!';
                    document.getElementById('countdown').style.color = 'var(--danger-color)';
                } else {
                    remaining--;
                }
            }, 1000);
        }

        // Обработчики событий
        document.getElementById('language-select').addEventListener('change', e => {
            applyLanguage(e.target.value);
        });

        document.getElementById('close-confirm-modal').addEventListener('click', () => {
            document.getElementById('confirmation-modal').classList.remove('active');
            clearInterval(countdownInterval);
        });

        // Обработчик формы входа
        document.getElementById('login-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            loginError.style.display = 'none';
            document.getElementById('login-loader').style.display = 'inline-block';
            document.getElementById('login-text').textContent = translations[currentLang].loginButton;
            document.getElementById('login-btn').disabled = true;

            try {
                const response = await fetch('/login', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({email, password})
                });
                
                const data = await response.json();
                
                if (data.error) {
                    let errorMessage = translations[currentLang][data.error] || data.error;
                    loginError.textContent = errorMessage;
                    loginError.style.display = 'block';
                    
                    if (data.requiresConfirmation) {
                        confirmationEmail = email;
                        showConfirmationModal();
                    }
                }
                
                if (response.ok && !data.requiresConfirmation) {
                    window.location.href = 'index.html';
                }
            } catch (error) {
                loginError.textContent = translations[currentLang].serverError;
                loginError.style.display = 'block';
            } finally {
                document.getElementById('login-loader').style.display = 'none';
                document.getElementById('login-text').textContent = translations[currentLang].loginButton;
                document.getElementById('login-btn').disabled = false;
            }
        });

        // Обработчик формы регистрации
        document.getElementById('register-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            const username = document.getElementById('register-username').value;
            const login = document.getElementById('register-login').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const confirm = document.getElementById('register-confirm').value;
            
            registerError.style.display = 'none';
            
            if (!username || !login || !email || !password || !confirm) {
                registerError.textContent = translations[currentLang].fillFields;
                registerError.style.display = "block";
                return;
            }
            
            if (password !== confirm) {
                registerError.textContent = translations[currentLang].passwordMismatch;
                registerError.style.display = 'block';
                return;
            }
            
            const strength = parseInt(document.getElementById('security-bar').style.width);
            if (strength < 75) {
                registerError.textContent = translations[currentLang].passwordWeak;
                registerError.style.display = 'block';
                return;
            }
            
            document.getElementById('register-loader').style.display = 'inline-block';
            document.getElementById('register-text').textContent = translations[currentLang].validating;
            document.getElementById('register-btn').disabled = true;

            try {
                const response = await fetch('/register', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({username, login, email, password})
                });
                
                const data = await response.json();
                
                if (data.result) {
                    if (response.ok) {
                        confirmationEmail = email;
                        showConfirmationModal();
                    } else {
                        registerError.textContent = data.result;
                        registerError.style.display = 'block';
                    }
                }
            } catch (error) {
                registerError.textContent = translations[currentLang].serverError;
                registerError.style.display = 'block';
            } finally {
                document.getElementById('register-loader').style.display = 'none';
                document.getElementById('register-text').textContent = translations[currentLang].registerButton;
                document.getElementById('register-btn').disabled = false;
            }
        });

        // Обработчик подтверждения кода
        document.getElementById('confirm-btn').addEventListener('click', async () => {
            const code = document.getElementById('confirmation-code').value;
            
            if (code.length !== 6) {
                document.getElementById('confirm-error').textContent = translations[currentLang].codeInvalid;
                document.getElementById('confirm-error').style.display = 'block';
                return;
            }
            
            document.getElementById('confirm-loader').style.display = 'inline-block';
            document.getElementById('confirm-text').textContent = translations[currentLang].validating;
            document.getElementById('confirm-btn').disabled = true;

            try {
                const response = await fetch('/confirm_email', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({email: confirmationEmail, code})
                });
                
                const data = await response.json();
                
                if (data.result) {
                    if (response.ok) {
                        document.getElementById('success-message').style.display = 'block';
                        setTimeout(() => {
                            document.getElementById('confirmation-modal').classList.remove('active');
                            document.getElementById('success-message').style.display = 'none';
                            if (document.getElementById('register-tab').classList.contains('active')) {
                                document.getElementById('login-tab').click();
                            }
                            document.getElementById('login-email').value = confirmationEmail;
                            document.getElementById('login-password').value = '';
                        }, 3000);
                    } else {
                        document.getElementById('confirm-error').textContent = data.result;
                        document.getElementById('confirm-error').style.display = 'block';
                        if (response.status === 403) {
                            clearInterval(countdownInterval);
                            document.getElementById('countdown').textContent = 'Попытки исчерпаны!';
                            document.getElementById('countdown').style.color = 'var(--danger-color)';
                            document.getElementById('confirm-btn').disabled = true;
                            document.getElementById('resend-code').style.pointerEvents = 'none';
                            document.getElementById('resend-code').style.opacity = '0.5';
                        }
                    }
                }
            } catch (error) {
                document.getElementById('confirm-error').textContent = translations[currentLang].serverError;
                document.getElementById('confirm-error').style.display = 'block';
            } finally {
                document.getElementById('confirm-loader').style.display = 'none';
                document.getElementById('confirm-text').textContent = translations[currentLang].confirmButton;
                document.getElementById('confirm-btn').disabled = false;
            }
        });

        // Повторная отправка кода
        document.getElementById('resend-code').addEventListener('click', async () => {
            clearInterval(countdownInterval);
            const originalText = document.getElementById('resend-code').innerHTML;
            document.getElementById('resend-code').innerHTML = '<span class="loader" style="display:inline-block; margin-right:5px;"></span> Отправка...';
            document.getElementById('resend-code').style.pointerEvents = 'none';

            try {
                const response = await fetch('/resend_code', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({email: confirmationEmail})
                });
                
                const data = await response.json();
                
                if (data.result) {
                    document.getElementById('confirm-error').textContent = data.result;
                    document.getElementById('confirm-error').style.color = 'var(--success-color)';
                    document.getElementById('confirm-error').style.display = 'block';
                    startCountdown(180);
                }
            } catch (error) {
                document.getElementById('confirm-error').textContent = translations[currentLang].serverError;
                document.getElementById('confirm-error').style.color = 'var(--danger-color)';
                document.getElementById('confirm-error').style.display = 'block';
            } finally {
                document.getElementById('resend-code').innerHTML = originalText;
                document.getElementById('resend-code').style.pointerEvents = 'auto';
            }
        });
    </script>
</body>
</html>